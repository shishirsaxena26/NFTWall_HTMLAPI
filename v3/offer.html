<!DOCTYPE html>
<html>
<head>
  <title>Offer Report</title>
  <style>
    table { border-collapse: collapse; width: 100%; font-size:small; }
    th, td { border: 1px solid #aaa; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    table td:nth-child(5),
    table th:nth-child(5) {
      background-color: #ABE098;  /* light highlight */
      font-weight: bold;          /* example styling */
      color: #333;
    }

    table td:nth-child(6),
    table th:nth-child(6) {
      background-color: #83D475;  /* light highlight */
      font-weight: bold;          /* example styling */
      color: #333;
    }

    table td:nth-child(7),
    table th:nth-child(7) {
      background-color: #57C84D;  /* light highlight */
      font-weight: bold;          /* example styling */
      color: #333;
    }

    table td:nth-child(11),
    table th:nth-child(11) {
      background-color: #000;  /* light highlight */
      font-weight: bold;          /* example styling */
      color: #FFDF00;
      text-shadow: 1px 1px 2px black, 0 0 25px blue, 0 0 5px red;
      font-size: 16px;
      text-align: center;
    }

    
  </style>
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
  <script>

  </script>
</head>
<body>

<h2 class="rptname">Offer [16-Oct ~ 05-Nov] Report</h2>
<table id="dataTable">
  <thead>
    <tr id="tableHeader"></tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  // Replace with your API URL
  let apiUrl = "https://api.nftwall.io:2096/api/call-proc?procedureName=get_rpt_OfferData"; 
  const params = new URLSearchParams(window.location.search);
  let page = params.get("page");  // will give "1" if ?forprime=1
  
  if(!page){
     page=1;
   }
    
  apiUrl = "https://api.nftwall.io:2096/api/call-proc?procedureName=get_rpt_OfferData&page="+page;
  document.querySelector(".rptname").textContent = "Offer Report [16-Oct ~ 05-Nov] {page number -"+page+"}";

  // Fetch data from API
fetch(apiUrl)
      .then(response => response.json())
      .then(apiResponse => {
        // Ensure API returned the expected structure
        if (!apiResponse.success || !apiResponse.data || !apiResponse.data[0]) {
          console.error("Unexpected API response:", apiResponse);
          return;
        }

        // Extract only the inner data array
        const jsonData = apiResponse.data[0];

        const tableHeader = document.getElementById("tableHeader");
        const tbody = document.querySelector("#dataTable tbody");

        // --- Create dynamic headers ---
        const keys = Object.keys(jsonData[0]);
        keys.forEach(key => {
          const th = document.createElement("th");
          th.textContent = key;
          tableHeader.appendChild(th);
        });

        // --- Fill table rows dynamically ---
        jsonData.forEach(item => {
          const row = document.createElement("tr");
          keys.forEach(key => {
            const td = document.createElement("td");
            td.textContent = item[key];
            row.appendChild(td);
          });
          tbody.appendChild(row);
        });
      })
      .catch(error => console.error("Error fetching data:", error));



</script>


<script>
  const address = "0x95d919E8c411D63060f091eAD34f711B337BD899";
  let apiUrl1 = `https://ozonescan.com/api/v2/addresses/${address}/transactions?filter=to`;

  let totalValue = BigInt(0); // Use BigInt for large numbers

  async function fetchAllTransactions(url) {
    try {
      let nextPageParams = null;

      do {
        const fullUrl = nextPageParams
          ? `${url}&block_number=${nextPageParams.block_number}&index=${nextPageParams.index}`
          : url;

        const response = await fetch(fullUrl);
        debugger;
        const data = await response.json();

        if (data && data.transactions) {
          data.transactions.forEach(tx => {
            totalValue += BigInt(tx.value);
          });
        }

        nextPageParams = data.next_page_params || null;
      } while (nextPageParams);

      console.log("Total sum of transaction values:", totalValue.toString());
      document.getElementById("totalValue").textContent = totalValue.toString();
      
    } catch (err) {
      console.error("Error fetching transactions:", err);
    }
  }

  fetchAllTransactions(apiUrl1);
</script>

<div>Total Transaction Value: <span id="totalValue">0</span></div>


</body>
</html>
